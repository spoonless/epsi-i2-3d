

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="fr" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="fr" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta content="David Gayerie" name="author" />
<meta content="Tutoriel three.js" name="description" />
<meta content="three.js, webgl, 3D" name="keywords" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Objets et scène &mdash; Documentation Visualisation 3D 1.0</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/custom_rtd_theme.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Recherche" href="../search.html" />
    <link rel="next" title="Les matériaux" href="materiaux.html" />
    <link rel="prev" title="Introduction et mise en place" href="introduction.html" /> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> Visualisation 3D
          

          
          </a>

          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Recherche dans les pages" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">three.js</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="introduction.html">Introduction et mise en place</a><ul>
<li class="toctree-l2"><a class="reference internal" href="introduction.html#chargement-asynchrone-en-local">Chargement asynchrone en local</a></li>
<li class="toctree-l2"><a class="reference internal" href="introduction.html#fichier-html-de-base">Fichier HTML de base</a></li>
<li class="toctree-l2"><a class="reference internal" href="introduction.html#creation-d-un-renderer">Création d’un renderer</a></li>
<li class="toctree-l2"><a class="reference internal" href="introduction.html#creation-d-une-camera">Création d’une caméra</a></li>
<li class="toctree-l2"><a class="reference internal" href="introduction.html#creation-d-une-scene">Création d’une scène</a></li>
<li class="toctree-l2"><a class="reference internal" href="introduction.html#rendu-d-une-scene">Rendu d’une scène</a></li>
<li class="toctree-l2"><a class="reference internal" href="introduction.html#redimensionnement-du-canevas">Redimensionnement du canevas</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Objets et scène</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#repere-de-coordonnees">Repère de coordonnées</a></li>
<li class="toctree-l2"><a class="reference internal" href="#mesh-et-geometry">Mesh et Geometry</a></li>
<li class="toctree-l2"><a class="reference internal" href="#les-transformations-dans-l-espace">Les transformations dans l’espace</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#exercice">Exercice</a></li>
<li class="toctree-l3"><a class="reference internal" href="#une-animation-simple">Une animation simple</a></li>
<li class="toctree-l3"><a class="reference internal" href="#hierarchie-d-objets">Hiérarchie d’objets</a></li>
<li class="toctree-l3"><a class="reference internal" href="#excercice">Excercice</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="materiaux.html">Les matériaux</a><ul>
<li class="toctree-l2"><a class="reference internal" href="materiaux.html#le-meshbasicmaterial">Le MeshBasicMaterial</a></li>
<li class="toctree-l2"><a class="reference internal" href="materiaux.html#les-lumieres">Les lumières</a></li>
<li class="toctree-l2"><a class="reference internal" href="materiaux.html#les-materiaux-reagissant-a-la-lumiere">Les matériaux réagissant à la lumière</a><ul>
<li class="toctree-l3"><a class="reference internal" href="materiaux.html#excercice">Excercice</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="materiaux.html#textures-et-maps">Textures et Maps</a><ul>
<li class="toctree-l3"><a class="reference internal" href="materiaux.html#chargement-d-une-texture">Chargement d’une texture</a></li>
<li class="toctree-l3"><a class="reference internal" href="materiaux.html#un-texture-comme-color-map">Un texture comme <em>color map</em></a></li>
<li class="toctree-l3"><a class="reference internal" href="materiaux.html#les-autres-types-de-textures">Les autres types de textures</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="materiaux.html#les-ombres">Les ombres</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="interactions.html">Les interactions</a><ul>
<li class="toctree-l2"><a class="reference internal" href="interactions.html#les-controleurs">Les contrôleurs</a><ul>
<li class="toctree-l3"><a class="reference internal" href="interactions.html#le-controleur-orbital">Le contrôleur orbital</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="interactions.html#le-lancer-de-rayon">Le lancer de rayon</a></li>
<li class="toctree-l2"><a class="reference internal" href="interactions.html#la-projection">La projection</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="chargement_scene.html">Chargement de modèle</a><ul>
<li class="toctree-l2"><a class="reference internal" href="chargement_scene.html#le-chargeur-gltf">Le chargeur glTF</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="animation_curve.html">Animation à partir de courbes</a><ul>
<li class="toctree-l2"><a class="reference internal" href="animation_curve.html#les-courbes">Les courbes</a></li>
<li class="toctree-l2"><a class="reference internal" href="animation_curve.html#representation-graphique-d-une-courbe">Représentation graphique d’une courbe</a></li>
<li class="toctree-l2"><a class="reference internal" href="animation_curve.html#animation-le-long-d-une-courbe">Animation le long d’une courbe</a></li>
<li class="toctree-l2"><a class="reference internal" href="animation_curve.html#exercice">Exercice</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Visualisation 3D</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Accueil</a> &raquo;</li>
        
      <li>Objets et scène</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
        
      </li>
    
  </ul>

  
  <div class="rst-breadcrumbs-buttons" role="navigation" aria-label="breadcrumb navigation">
      
        <a href="materiaux.html" class="btn btn-neutral float-right" title="Les matériaux" accesskey="n">Suivant <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="introduction.html" class="btn btn-neutral" title="Introduction et mise en place" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Précédent</a>
      
  </div>
  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="objets-et-scene">
<h1>Objets et scène<a class="headerlink" href="#objets-et-scene" title="Lien permanent vers ce titre">¶</a></h1>
<p>Dans ce chapitre, nous verrons comment organiser et animer les objets dans une
scène 3D.</p>
<div class="section" id="repere-de-coordonnees">
<h2>Repère de coordonnées<a class="headerlink" href="#repere-de-coordonnees" title="Lien permanent vers ce titre">¶</a></h2>
<p><a class="reference external" href="https://threejs.org/">three.js</a> utilise le même repère de coordonnées que <a class="reference external" href="https://www.khronos.org/webgl/">WebGL</a> (qui l’hérite de OpenGL).
Dans ce repère, l’axe Y pointe vers le haut. Si on cale les axes X et Y sur un écran,
alors le centre se situe en bas à gauche de l’écran et l’axe Z pointe vers l’extérieur
de l’écran. Ce système de coordonnées est dit à main droite.</p>
<img alt="../_images/opengl_coordinate_system.png" src="../_images/opengl_coordinate_system.png" />
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Par défaut, lorsqu’on crée une caméra, celle-ci est placée à l’origine de la scène
(0, 0, 0) et pointe vers l’axe -Z.</p>
</div>
<img alt="../_images/opengl_coordinate_system_with_camera.png" src="../_images/opengl_coordinate_system_with_camera.png" />
</div>
<div class="section" id="mesh-et-geometry">
<span id="threejs-mesh"></span><h2>Mesh et Geometry<a class="headerlink" href="#mesh-et-geometry" title="Lien permanent vers ce titre">¶</a></h2>
<p><a class="reference external" href="https://threejs.org/docs/index.html#api/en/core/Object3D">Object3D</a> est la classe de base qui définit un objet qui peut être ajouté
dans une scène. Un objet 3D possède notamment une position dans l’espace de la scène.
Il existe beaucoup de classes qui héritent de <a class="reference external" href="https://threejs.org/docs/index.html#api/en/core/Object3D">Object3D</a> (dont <a class="reference external" href="https://threejs.org/docs/index.html#api/en/cameras/Camera">Camera</a>). Parmi elles,
la classe <a class="reference external" href="https://threejs.org/docs/index.html#api/en/objects/Mesh">Mesh</a>. Un <strong>mesh</strong> (ou maillage) représente une figure géométrique construite
à partir de triangles. Un <em>mesh</em> est l’association de données géométriques et d’information
de rendu (le matériau).</p>
<p>Une figure géométrique est construite à partir de <strong>vertices</strong> (au singulier <strong>vertex</strong>).
Un <em>vertex</em> est un point défini par ses coordonnées dans l’espace (x, y, z).
Une géométrie 3D est définit ensuite par ses faces, chacune d’elle étant composée de trois
<em>vertices</em>. La classe <a class="reference external" href="https://threejs.org/docs/index.html#api/en/core/Geometry">Geometry</a> permet de représenter une figure dans <a class="reference external" href="https://threejs.org/">three.js</a>
en définissant des <em>vertices</em> et leur association pour créer des faces.</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">geometry</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">THREE</span><span class="p">.</span><span class="nx">Geometry</span><span class="p">();</span>
<span class="nx">geometry</span><span class="p">.</span><span class="nx">vertices</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span>
          <span class="k">new</span> <span class="nx">THREE</span><span class="p">.</span><span class="nx">Vector3</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">),</span>
          <span class="k">new</span> <span class="nx">THREE</span><span class="p">.</span><span class="nx">Vector3</span><span class="p">(</span> <span class="mi">1</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">),</span>
          <span class="k">new</span> <span class="nx">THREE</span><span class="p">.</span><span class="nx">Vector3</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">),</span>
          <span class="k">new</span> <span class="nx">THREE</span><span class="p">.</span><span class="nx">Vector3</span><span class="p">(</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">)</span>
<span class="p">);</span>

<span class="nx">geometry</span><span class="p">.</span><span class="nx">faces</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span>
          <span class="k">new</span> <span class="nx">THREE</span><span class="p">.</span><span class="nx">Face3</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
          <span class="k">new</span> <span class="nx">THREE</span><span class="p">.</span><span class="nx">Face3</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="p">);</span>
</pre></div>
</div>
<p>Dans le code ci-dessus, on crée un carré qui est en fait l’association de deux triangles.
Les faces sont définies par des objets de type <a class="reference external" href="https://threejs.org/docs/index.html#api/en/core/Face3">Face3</a> qui contiennent
les indices des <em>vertices</em>.</p>
<p>On peut ensuite passer cet objet de type <a class="reference external" href="https://threejs.org/docs/index.html#api/en/core/Geometry">Geometry</a> en paramètre du constructeur de <a class="reference external" href="https://threejs.org/docs/index.html#api/en/objects/Mesh">Mesh</a>.
Comme ce dernier hérite de <a class="reference external" href="https://threejs.org/docs/index.html#api/en/core/Object3D">Object3D</a>, il est possible de l’ajouter à la scène :</p>
<div class="highlight-html notranslate"><div class="highlight"><pre><span></span><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="p">&lt;</span><span class="nt">html</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">charset</span><span class="o">=</span><span class="s">utf-8</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>three.js app<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">style</span><span class="p">&gt;</span>
      <span class="nt">body</span> <span class="p">{</span>
        <span class="k">margin</span><span class="p">:</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">overflow</span><span class="p">:</span> <span class="kc">hidden</span><span class="p">;</span>
      <span class="p">}</span>
    <span class="p">&lt;/</span><span class="nt">style</span><span class="p">&gt;</span>
  <span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">src</span><span class="o">=</span><span class="s">&quot;https://threejs.org/build/three.min.js&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span><span class="p">&gt;</span>
      <span class="c1">// création du renderer</span>
      <span class="kd">var</span> <span class="nx">renderer</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">THREE</span><span class="p">.</span><span class="nx">WebGLRenderer</span><span class="p">();</span>
      <span class="nb">document</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">renderer</span><span class="p">.</span><span class="nx">domElement</span><span class="p">);</span>
      <span class="nx">renderer</span><span class="p">.</span><span class="nx">setSize</span><span class="p">(</span><span class="nb">window</span><span class="p">.</span><span class="nx">innerWidth</span><span class="p">,</span> <span class="nb">window</span><span class="p">.</span><span class="nx">innerHeight</span><span class="p">);</span>

      <span class="c1">// création de la caméra</span>
      <span class="kd">var</span> <span class="nx">camera</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">THREE</span><span class="p">.</span><span class="nx">PerspectiveCamera</span><span class="p">(</span><span class="mi">45</span><span class="p">,</span> <span class="nb">window</span><span class="p">.</span><span class="nx">innerWidth</span> <span class="o">/</span> <span class="nb">window</span><span class="p">.</span><span class="nx">innerHeight</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">1000</span><span class="p">);</span>

      <span class="c1">// création de la scène</span>
      <span class="kd">var</span> <span class="nx">scene</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">THREE</span><span class="p">.</span><span class="nx">Scene</span><span class="p">();</span>

      <span class="c1">// couleur de fond noire</span>
      <span class="nx">scene</span><span class="p">.</span><span class="nx">background</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">THREE</span><span class="p">.</span><span class="nx">Color</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>

      <span class="c1">// création d&#39;une géométrie</span>
      <span class="kd">var</span> <span class="nx">geometry</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">THREE</span><span class="p">.</span><span class="nx">Geometry</span><span class="p">();</span>
      <span class="nx">geometry</span><span class="p">.</span><span class="nx">vertices</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span>
                <span class="k">new</span> <span class="nx">THREE</span><span class="p">.</span><span class="nx">Vector3</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">),</span>
                <span class="k">new</span> <span class="nx">THREE</span><span class="p">.</span><span class="nx">Vector3</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">),</span>
                <span class="k">new</span> <span class="nx">THREE</span><span class="p">.</span><span class="nx">Vector3</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">),</span>
                <span class="k">new</span> <span class="nx">THREE</span><span class="p">.</span><span class="nx">Vector3</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">)</span>
      <span class="p">);</span>

      <span class="nx">geometry</span><span class="p">.</span><span class="nx">faces</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span>
                <span class="k">new</span> <span class="nx">THREE</span><span class="p">.</span><span class="nx">Face3</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
                <span class="k">new</span> <span class="nx">THREE</span><span class="p">.</span><span class="nx">Face3</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
      <span class="p">);</span>

      <span class="c1">// création du mesh et ajout dans la scène</span>
      <span class="nx">scene</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="k">new</span> <span class="nx">THREE</span><span class="p">.</span><span class="nx">Mesh</span><span class="p">(</span><span class="nx">geometry</span><span class="p">));</span>

      <span class="c1">// rendu</span>
      <span class="nx">renderer</span><span class="p">.</span><span class="nx">render</span><span class="p">(</span><span class="nx">scene</span><span class="p">,</span> <span class="nx">camera</span><span class="p">);</span>
    <span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
  <span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</pre></div>
</div>
<p>Vous pouvez <a class="reference download internal" download="" href="../_downloads/e528a119bbdf483506def4df04caac0f/scene002.html"><code class="xref download docutils literal notranslate"><span class="pre">télécharger</span> <span class="pre">ce</span> <span class="pre">fichier</span> <span class="pre">directement</span></code></a>.</p>
<p>Créer manuellement les informations pour une <a class="reference external" href="https://threejs.org/docs/index.html#api/en/core/Geometry">Geometry</a> est assez compliqué. Heureusement,
<a class="reference external" href="https://threejs.org/">three.js</a> fournit un ensemble de classes qui héritent toutes de <a class="reference external" href="https://threejs.org/docs/index.html#api/en/core/Geometry">Geometry</a> et qui s’occupent
de créer les <em>vertices</em> et les faces pour des figures élémentaires tels que
<a class="reference external" href="https://threejs.org/docs/index.html#api/en/geometries/BoxGeometry">cube</a>, <a class="reference external" href="https://threejs.org/docs/index.html#api/en/geometries/SphereGeometry">sphère</a>, <a class="reference external" href="https://threejs.org/docs/index.html#api/en/geometries/IcosahedronGeometry">icosaèdre</a>…</p>
</div>
<div class="section" id="les-transformations-dans-l-espace">
<h2>Les transformations dans l’espace<a class="headerlink" href="#les-transformations-dans-l-espace" title="Lien permanent vers ce titre">¶</a></h2>
<p>Une instance de <a class="reference external" href="https://threejs.org/docs/index.html#api/en/core/Object3D">Object3D</a> possède des propriétés qui définissent son positionnement
dans l’espace local de coordonnées :</p>
<dl class="docutils">
<dt><a class="reference external" href="https://threejs.org/docs/index.html#api/en/core/Object3D.position">position</a></dt>
<dd>indique la position dans l’espace. Par défaut : (0, 0, 0)</dd>
<dt><a class="reference external" href="https://threejs.org/docs/index.html#api/en/core/Object3D.rotation">rotation</a></dt>
<dd><p class="first">indique la rotation en radians autour des axes X, Y, Z (rotation d’Euler)</p>
<div class="last admonition note">
<p class="first admonition-title">Note</p>
<p>Pour passer d’une valeur en degrés à une valeur en radians, vous pouvez utiliser
la méthode :</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="nx">THREE</span><span class="p">.</span><span class="nb">Math</span><span class="p">.</span><span class="nx">degToRad</span><span class="p">(</span><span class="nx">degrees</span> <span class="o">:</span> <span class="nx">Float</span><span class="p">)</span>
</pre></div>
</div>
<p>Pour passer d’une valeur en radians à une valeur en degrés, vous pouvez utiliser
la méthode :</p>
<div class="last highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="nx">THREE</span><span class="p">.</span><span class="nb">Math</span><span class="p">.</span><span class="nx">radToDeg</span><span class="p">(</span><span class="nx">radians</span> <span class="o">:</span> <span class="nx">Float</span><span class="p">)</span>
</pre></div>
</div>
</div>
</dd>
<dt><a class="reference external" href="https://threejs.org/docs/index.html#api/en/core/Object3D.scale">scale</a></dt>
<dd>indique la mise à l’échelle suivant les axes X, Y, Z. Par défaut : (1, 1, 1)</dd>
</dl>
<div class="admonition important">
<p class="first admonition-title">Important</p>
<p><a class="reference external" href="https://threejs.org/">three.js</a> applique <strong>toujours</strong> ces propriétés dans le même ordre :</p>
<ol class="last arabic simple">
<li>mise à l’échelle (<em>scale</em>)</li>
<li>rotation</li>
<li>position</li>
</ol>
</div>
<p>La méthode <a class="reference external" href="https://threejs.org/docs/index.html#api/en/core/Object3D.lookAt">lookAt</a> est également très pratique (surtout avec la caméra) puisqu’elle
modifie la rotation d’un objet de manière à ce que son axe local -Z (0, 0, -1) pointe vers
le <a class="reference external" href="https://threejs.org/docs/index.html#api/en/math/Vector3">Vector3</a> passé en paramètre de la méthode.</p>
<p>Nous pouvons ainsi placer les objets dans la scène selon ces trois propriétés fondamentales
(y compris la caméra).</p>
<div class="highlight-html notranslate"><div class="highlight"><pre><span></span><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="p">&lt;</span><span class="nt">html</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">charset</span><span class="o">=</span><span class="s">utf-8</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>three.js app<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">style</span><span class="p">&gt;</span>
      <span class="nt">body</span> <span class="p">{</span>
        <span class="k">margin</span><span class="p">:</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">overflow</span><span class="p">:</span> <span class="kc">hidden</span><span class="p">;</span>
      <span class="p">}</span>
    <span class="p">&lt;/</span><span class="nt">style</span><span class="p">&gt;</span>
  <span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">src</span><span class="o">=</span><span class="s">&quot;https://threejs.org/build/three.min.js&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span><span class="p">&gt;</span>
      <span class="c1">// création du renderer</span>
      <span class="kd">var</span> <span class="nx">renderer</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">THREE</span><span class="p">.</span><span class="nx">WebGLRenderer</span><span class="p">();</span>
      <span class="nb">document</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">renderer</span><span class="p">.</span><span class="nx">domElement</span><span class="p">);</span>
      <span class="nx">renderer</span><span class="p">.</span><span class="nx">setSize</span><span class="p">(</span><span class="nb">window</span><span class="p">.</span><span class="nx">innerWidth</span><span class="p">,</span> <span class="nb">window</span><span class="p">.</span><span class="nx">innerHeight</span><span class="p">);</span>

      <span class="c1">// création de la caméra</span>
      <span class="kd">var</span> <span class="nx">camera</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">THREE</span><span class="p">.</span><span class="nx">PerspectiveCamera</span><span class="p">(</span><span class="mi">45</span><span class="p">,</span> <span class="nb">window</span><span class="p">.</span><span class="nx">innerWidth</span> <span class="o">/</span> <span class="nb">window</span><span class="p">.</span><span class="nx">innerHeight</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">1000</span><span class="p">);</span>

      <span class="c1">// création de la scène</span>
      <span class="kd">var</span> <span class="nx">scene</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">THREE</span><span class="p">.</span><span class="nx">Scene</span><span class="p">();</span>

      <span class="c1">// couleur de fond noire</span>
      <span class="nx">scene</span><span class="p">.</span><span class="nx">background</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">THREE</span><span class="p">.</span><span class="nx">Color</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>

      <span class="c1">// création du mesh et ajout dans la scène</span>
      <span class="kd">var</span> <span class="nx">mesh</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">THREE</span><span class="p">.</span><span class="nx">Mesh</span><span class="p">(</span><span class="k">new</span> <span class="nx">THREE</span><span class="p">.</span><span class="nx">TorusGeometry</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mf">.6</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">50</span><span class="p">));</span>
      <span class="nx">scene</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">mesh</span><span class="p">);</span>
      <span class="nx">scene</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">camera</span><span class="p">);</span>

      <span class="c1">// positionnement du mesh</span>
      <span class="nx">mesh</span><span class="p">.</span><span class="nx">position</span><span class="p">.</span><span class="nx">z</span> <span class="o">=</span> <span class="o">-</span><span class="mi">3</span><span class="p">;</span>
      <span class="nx">mesh</span><span class="p">.</span><span class="nx">rotation</span><span class="p">.</span><span class="nx">x</span> <span class="o">=</span> <span class="o">-</span><span class="mf">.5</span><span class="p">;</span>
      <span class="nx">mesh</span><span class="p">.</span><span class="nx">rotation</span><span class="p">.</span><span class="nx">y</span> <span class="o">=</span> <span class="mf">2.5</span><span class="p">;</span>

      <span class="c1">// positionnement de la caméra</span>
      <span class="nx">camera</span><span class="p">.</span><span class="nx">position</span><span class="p">.</span><span class="nx">z</span> <span class="o">=</span> <span class="mi">5</span><span class="p">;</span>
      <span class="nx">camera</span><span class="p">.</span><span class="nx">position</span><span class="p">.</span><span class="nx">y</span> <span class="o">=</span> <span class="mi">4</span><span class="p">;</span>
      <span class="nx">camera</span><span class="p">.</span><span class="nx">lookAt</span><span class="p">(</span><span class="nx">mesh</span><span class="p">.</span><span class="nx">position</span><span class="p">);</span>

      <span class="c1">// rendu</span>
      <span class="nx">renderer</span><span class="p">.</span><span class="nx">render</span><span class="p">(</span><span class="nx">scene</span><span class="p">,</span> <span class="nx">camera</span><span class="p">);</span>
    <span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
  <span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</pre></div>
</div>
<p>Vous pouvez <a class="reference download internal" download="" href="../_downloads/e89c7148bd8e2a1bfe4dd35eca3db617/scene003.html"><code class="xref download docutils literal notranslate"><span class="pre">télécharger</span> <span class="pre">ce</span> <span class="pre">fichier</span> <span class="pre">directement</span></code></a>.</p>
<p>Il existe également des méthodes utilitaires dans la classe <a class="reference external" href="https://threejs.org/docs/index.html#api/en/core/Object3D">Object3D</a> permettant de réaliser
des transformations de coordonnées :</p>
<ul class="simple">
<li>translation : <a class="reference external" href="https://threejs.org/docs/index.html#api/en/core/Object3D.translateOnAxis">translateOnAxis</a>, <a class="reference external" href="https://threejs.org/docs/index.html#api/en/core/Object3D.translateX">translateX</a>, <a class="reference external" href="https://threejs.org/docs/index.html#api/en/core/Object3D.translateY">translateY</a>, <a class="reference external" href="https://threejs.org/docs/index.html#api/en/core/Object3D.translateZ">translateZ</a></li>
<li>rotation selon un axe : <a class="reference external" href="https://threejs.org/docs/index.html#api/en/core/Object3D.rotateOnAxis">rotateOnAxis</a>, <a class="reference external" href="https://threejs.org/docs/index.html#api/en/core/Object3D.rotateOnWorldAxis">rotateOnWorldAxis</a>, <a class="reference external" href="https://threejs.org/docs/index.html#api/en/core/Object3D.rotateX">rotateX</a>, <a class="reference external" href="https://threejs.org/docs/index.html#api/en/core/Object3D.rotateY">rotateY</a>, <a class="reference external" href="https://threejs.org/docs/index.html#api/en/core/Object3D.rotateZ">rotateZ</a></li>
</ul>
<div class="admonition important">
<p class="first admonition-title">Important</p>
<p>L’ordre dans lequel vous appliquez les transformations (c’est-à-dire l’ordre
d’appel de ces méthodes) est important. Les opérations seront réalisées dans
<strong>l’ordre inverse</strong>. Ainsi si vous appelez :</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="nx">obj</span><span class="p">.</span><span class="nx">rotateY</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">PI</span><span class="p">);</span>
<span class="nx">obj</span><span class="p">.</span><span class="nx">translateX</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span>
</pre></div>
</div>
<p class="last">Pour un objet situé initialement à l’origine de la scène (0, 0, 0).
D’abord <a class="reference external" href="https://threejs.org/">three.js</a> effectue une translation de l’objet sur son axe local X puis
<a class="reference external" href="https://threejs.org/">three.js</a> effectue une rotation de 180° sur l’axe Y. Donc, l’objet
se trouvera au final en position (-2, 0, 0) !</p>
</div>
<p>Il y a donc une différence importante lorsque l’on utilise dans un programme
les propriétés (<em>position</em>, <em>rotation</em>, <em>scale</em>) ou les méthodes de transformations.
Pour les premières, on se contente de décrire la situation finale de l’objet, ce qui
est très pratique pour placer l’objet dans la scène. Avec les secondes, on décrit
une succession d’opérations à appliquer sur un objet, ce qui est très pratique pour
réaliser des animations.</p>
<div class="section" id="exercice">
<h3>Exercice<a class="headerlink" href="#exercice" title="Lien permanent vers ce titre">¶</a></h3>
<div class="exercice admonition">
<p class="first admonition-title">Contrôler les transformations d’un objet</p>
<p>Créez une page HTML avec un canevas faisant le rendu 3D d’un cube (<a class="reference external" href="https://threejs.org/docs/index.html#api/en/geometries/BoxGeometry">BoxGeometry</a>). Ajoutez
un formulaire HTML permettant de contrôler la position (sur les axes X, Y et Z),
la rotation (sur les axes X, Y et Z) et la mise à l’échelle du cube.</p>
<p class="last">Pour le formulaire, vous pouvez utiliser des <code class="docutils literal notranslate"><span class="pre">&lt;input&gt;</span></code> de type <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/input/range">range</a>. Si
vous le souhaitez, vous pouvez aussi utiliser la bibliothèque JavaScript
<a class="reference external" href="http://workshop.chromeexperiments.com/examples/gui/#1--Basic-Usage">dat.GUI</a> qui permet d’ajouter assez facilement des <em>widgets</em> pour contrôler
le contenu d’une page.</p>
</div>
</div>
<div class="section" id="une-animation-simple">
<h3>Une animation simple<a class="headerlink" href="#une-animation-simple" title="Lien permanent vers ce titre">¶</a></h3>
<p>Pour animer de manière assez simpliste les éléments dans la scène, il suffit de
rappeler régulièrement la méthode <a class="reference external" href="https://threejs.org/docs/index.html#api/en/renderers/WebGLRenderer.render">render</a> après avoir mis à jour la position des éléments.</p>
<p>Pour cela nous pouvons utiliser la méthode JavaScript standard <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/API/window/requestAnimationFrame">requestAnimationFrame</a>.
Cette méthode prend en paramètre une fonction qui sera appelée dès que l’animation
doit être rafraîchie (généralement la méthode est appelée au bout de 1/60 <sup>ième</sup> de seconde).</p>
<div class="highlight-html notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="p">&lt;</span><span class="nt">html</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">charset</span><span class="o">=</span><span class="s">utf-8</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>three.js app<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">style</span><span class="p">&gt;</span>
      <span class="nt">body</span> <span class="p">{</span>
        <span class="k">margin</span><span class="p">:</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">overflow</span><span class="p">:</span> <span class="kc">hidden</span><span class="p">;</span>
      <span class="p">}</span>
    <span class="p">&lt;/</span><span class="nt">style</span><span class="p">&gt;</span>
  <span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">src</span><span class="o">=</span><span class="s">&quot;https://threejs.org/build/three.min.js&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span><span class="p">&gt;</span>
      <span class="c1">// création du renderer</span>
      <span class="kd">var</span> <span class="nx">renderer</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">THREE</span><span class="p">.</span><span class="nx">WebGLRenderer</span><span class="p">();</span>
      <span class="nb">document</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">renderer</span><span class="p">.</span><span class="nx">domElement</span><span class="p">);</span>
      <span class="nx">renderer</span><span class="p">.</span><span class="nx">setSize</span><span class="p">(</span><span class="nb">window</span><span class="p">.</span><span class="nx">innerWidth</span><span class="p">,</span> <span class="nb">window</span><span class="p">.</span><span class="nx">innerHeight</span><span class="p">);</span>

      <span class="c1">// création de la caméra</span>
      <span class="kd">var</span> <span class="nx">camera</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">THREE</span><span class="p">.</span><span class="nx">PerspectiveCamera</span><span class="p">(</span><span class="mi">45</span><span class="p">,</span> <span class="nb">window</span><span class="p">.</span><span class="nx">innerWidth</span> <span class="o">/</span> <span class="nb">window</span><span class="p">.</span><span class="nx">innerHeight</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">1000</span><span class="p">);</span>

      <span class="c1">// création de la scène</span>
      <span class="kd">var</span> <span class="nx">scene</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">THREE</span><span class="p">.</span><span class="nx">Scene</span><span class="p">();</span>

      <span class="c1">// couleur de fond noire</span>
      <span class="nx">scene</span><span class="p">.</span><span class="nx">background</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">THREE</span><span class="p">.</span><span class="nx">Color</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>

      <span class="c1">// création du mesh et ajout dans la scène</span>
      <span class="kd">var</span> <span class="nx">torus</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">THREE</span><span class="p">.</span><span class="nx">Mesh</span><span class="p">(</span><span class="k">new</span> <span class="nx">THREE</span><span class="p">.</span><span class="nx">TorusGeometry</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mf">.6</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">50</span><span class="p">));</span>
      <span class="kd">var</span> <span class="nx">sphere</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">THREE</span><span class="p">.</span><span class="nx">Mesh</span><span class="p">(</span><span class="k">new</span> <span class="nx">THREE</span><span class="p">.</span><span class="nx">SphereGeometry</span><span class="p">());</span>
      <span class="nx">scene</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">torus</span><span class="p">);</span>
      <span class="nx">scene</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">sphere</span><span class="p">);</span>
      <span class="nx">scene</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">camera</span><span class="p">);</span>

      <span class="c1">// positionnement de la caméra</span>
      <span class="nx">camera</span><span class="p">.</span><span class="nx">position</span><span class="p">.</span><span class="nx">z</span> <span class="o">=</span> <span class="mi">15</span><span class="p">;</span>

      <span class="kd">function</span> <span class="nx">animate</span><span class="p">()</span> <span class="p">{</span>
        <span class="nx">torus</span><span class="p">.</span><span class="nx">rotateY</span><span class="p">(</span><span class="mf">.1</span><span class="p">);</span>

        <span class="nx">sphere</span><span class="p">.</span><span class="nx">position</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
        <span class="nx">sphere</span><span class="p">.</span><span class="nx">rotateZ</span><span class="p">(</span><span class="mf">.1</span><span class="p">);</span>
        <span class="nx">sphere</span><span class="p">.</span><span class="nx">translateX</span><span class="p">(</span><span class="mi">4</span><span class="p">);</span>

        <span class="nx">requestAnimationFrame</span><span class="p">(</span><span class="nx">animate</span><span class="p">);</span>
        <span class="nx">renderer</span><span class="p">.</span><span class="nx">render</span><span class="p">(</span><span class="nx">scene</span><span class="p">,</span> <span class="nx">camera</span><span class="p">);</span>
      <span class="p">}</span>

      <span class="nx">animate</span><span class="p">();</span>
    <span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
  <span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</pre></div>
</td></tr></table></div>
<p>Vous pouvez <a class="reference download internal" download="" href="../_downloads/4a1b88f162b1f2acb1cd1a8e52713ddd/scene004.html"><code class="xref download docutils literal notranslate"><span class="pre">télécharger</span> <span class="pre">ce</span> <span class="pre">fichier</span> <span class="pre">directement</span></code></a>.</p>
<p>La fonction <code class="docutils literal notranslate"><span class="pre">animate()</span></code> est appelée à la ligne 51. Elle se passe
elle-même en paramètre de <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/API/window/requestAnimationFrame">requestAnimationFrame</a> (ligne 47) avant d’appeler le <em>renderer</em>
pour faire un rendu de l’image.</p>
<div class="admonition important">
<p class="first admonition-title">Important</p>
<p>Il faut garder à l’esprit que la fonction passée en paramètre de <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/API/window/requestAnimationFrame">requestAnimationFrame</a>
devrait être appelée environ 60 fois par seconde. Il est donc important qu’elle
s’exécute aussi rapidement que possible. Il faut donc penser à réaliser le
plus de traitement avant de démarrer l’animation. Il faut également éviter de
créer trop d’objets lors de son exécution. À ce titre, <a class="reference external" href="https://threejs.org/">three.js</a> fournit beaucoup
de méthodes qui, soit retournent de nouveaux objets, soit acceptent un paramètre
de sortie qui sera mis à jour afin d’éviter de créer inutilement de nouveaux objets.</p>
<p class="last">Si vous voulez monitorer les performances de votre scène, vous pouvez utiliser
la bibliothèque <a class="reference external" href="https://github.com/mrdoob/stats.js/">stats.js</a> pour afficher des informations de débogage (notamment
le FPS).</p>
</div>
</div>
<div class="section" id="hierarchie-d-objets">
<h3>Hiérarchie d’objets<a class="headerlink" href="#hierarchie-d-objets" title="Lien permanent vers ce titre">¶</a></h3>
<p>Une instance de <a class="reference external" href="https://threejs.org/docs/index.html#api/en/core/Object3D">Object3D</a> possède la propriété <a class="reference external" href="https://threejs.org/docs/index.html#api/en/core/Object3D.children">children</a> qui est un tableau des instances
de <a class="reference external" href="https://threejs.org/docs/index.html#api/en/core/Object3D">Object3D</a> filles. Il est ainsi possible de créer une hiérarchie d’objets afin de représenter
la scène sous la forme d’un arbre.</p>
<p>Les transformations (translation, rotation, mise à l’échelle) effectuées sur un objet
de la scène, sont également appliquées à tous les objets fils de cet objet. On crée
ainsi une chaîne de transformation.</p>
<div class="highlight-html notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="p">&lt;</span><span class="nt">html</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">charset</span><span class="o">=</span><span class="s">utf-8</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>three.js app<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">style</span><span class="p">&gt;</span>
      <span class="nt">body</span> <span class="p">{</span>
        <span class="k">margin</span><span class="p">:</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">overflow</span><span class="p">:</span> <span class="kc">hidden</span><span class="p">;</span>
      <span class="p">}</span>
    <span class="p">&lt;/</span><span class="nt">style</span><span class="p">&gt;</span>
  <span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">src</span><span class="o">=</span><span class="s">&quot;https://threejs.org/build/three.min.js&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span><span class="p">&gt;</span>
      <span class="c1">// création du renderer</span>
      <span class="kd">var</span> <span class="nx">renderer</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">THREE</span><span class="p">.</span><span class="nx">WebGLRenderer</span><span class="p">();</span>
      <span class="nb">document</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">renderer</span><span class="p">.</span><span class="nx">domElement</span><span class="p">);</span>
      <span class="nx">renderer</span><span class="p">.</span><span class="nx">setSize</span><span class="p">(</span><span class="nb">window</span><span class="p">.</span><span class="nx">innerWidth</span><span class="p">,</span> <span class="nb">window</span><span class="p">.</span><span class="nx">innerHeight</span><span class="p">);</span>

      <span class="c1">// création de la caméra</span>
      <span class="kd">var</span> <span class="nx">camera</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">THREE</span><span class="p">.</span><span class="nx">PerspectiveCamera</span><span class="p">(</span><span class="mi">45</span><span class="p">,</span> <span class="nb">window</span><span class="p">.</span><span class="nx">innerWidth</span> <span class="o">/</span> <span class="nb">window</span><span class="p">.</span><span class="nx">innerHeight</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">1000</span><span class="p">);</span>

      <span class="c1">// création de la scène</span>
      <span class="kd">var</span> <span class="nx">scene</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">THREE</span><span class="p">.</span><span class="nx">Scene</span><span class="p">();</span>

      <span class="c1">// couleur de fond noire</span>
      <span class="nx">scene</span><span class="p">.</span><span class="nx">background</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">THREE</span><span class="p">.</span><span class="nx">Color</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>

      <span class="c1">// création du mesh et ajout dans la scène</span>
      <span class="kd">var</span> <span class="nx">sphere</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">THREE</span><span class="p">.</span><span class="nx">Mesh</span><span class="p">(</span><span class="k">new</span> <span class="nx">THREE</span><span class="p">.</span><span class="nx">SphereGeometry</span><span class="p">());</span>
      <span class="nx">sphere</span><span class="p">.</span><span class="nx">position</span><span class="p">.</span><span class="nx">x</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
      <span class="nx">scene</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">sphere</span><span class="p">);</span>

      <span class="c1">// création du mesh et ajout comme fils du premier mesh</span>
      <span class="kd">var</span> <span class="nx">cubeFils</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">THREE</span><span class="p">.</span><span class="nx">Mesh</span><span class="p">(</span><span class="k">new</span> <span class="nx">THREE</span><span class="p">.</span><span class="nx">BoxGeometry</span><span class="p">());</span>
      <span class="nx">sphere</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">cubeFils</span><span class="p">);</span>
      <span class="nx">cubeFils</span><span class="p">.</span><span class="nx">position</span><span class="p">.</span><span class="nx">y</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span>

      <span class="c1">// positionnement de la caméra</span>
      <span class="nx">camera</span><span class="p">.</span><span class="nx">position</span><span class="p">.</span><span class="nx">z</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span>

      <span class="nx">renderer</span><span class="p">.</span><span class="nx">render</span><span class="p">(</span><span class="nx">scene</span><span class="p">,</span> <span class="nx">camera</span><span class="p">);</span>
    <span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
  <span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</pre></div>
</td></tr></table></div>
<p>Vous pouvez <a class="reference download internal" download="" href="../_downloads/2e45874d345fd829fd92d1907eaa8d26/scene005.html"><code class="xref download docutils literal notranslate"><span class="pre">télécharger</span> <span class="pre">ce</span> <span class="pre">fichier</span> <span class="pre">directement</span></code></a>.</p>
<p>Dans l’exemple ci-dessus on crée une sphère (par défaut au centre de la scène) et
on positionne cette sphère à (2,0,0) à la ligne 32. Puis, on crée un cube
(<a class="reference external" href="https://threejs.org/docs/index.html#api/en/geometries/BoxGeometry">BoxGeometry</a>) que l’on ajoute comme fils à la sphère et on positionne ce cube à
(0,3,0) à la ligne 38. Comme le cube est fils de la sphère, il hérite de sa translation
le long de l’axe X. La position finale du cube dans la scène est donc (2,3,0).</p>
<p>Les transformations appliquées à un objet le sont toujours dans son <strong>espace de coordonnées
local</strong> (<em>local space</em>) ou <strong>espace de l’objet</strong>, c’est-à-dire avant que les
transformations héritées de son parent ne soient appliquées. Lorsque toute la hiérarchie
des transformations est appliquée, on obtient la position, la rotation et la mise à échelle
de l’objet dans <strong>l’espace de coordonnées du monde</strong> (<em>world space</em>).</p>
<p>Pour réaliser des transformations complexes, il est possible de créer des instances
de <a class="reference external" href="https://threejs.org/docs/index.html#api/en/objects/Group">Group</a>. Ces objets n’ont aucune géométrie mais ils permettent d’ajouter un niveau
dans la hiérarchie d’objets et de contrôler plus facilement les transformations.</p>
<div class="highlight-html notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="p">&lt;</span><span class="nt">html</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">charset</span><span class="o">=</span><span class="s">utf-8</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>three.js app<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">style</span><span class="p">&gt;</span>
      <span class="nt">body</span> <span class="p">{</span>
        <span class="k">margin</span><span class="p">:</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">overflow</span><span class="p">:</span> <span class="kc">hidden</span><span class="p">;</span>
      <span class="p">}</span>
    <span class="p">&lt;/</span><span class="nt">style</span><span class="p">&gt;</span>
  <span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">src</span><span class="o">=</span><span class="s">&quot;https://threejs.org/build/three.min.js&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span><span class="p">&gt;</span>
      <span class="c1">// création du renderer</span>
      <span class="kd">var</span> <span class="nx">renderer</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">THREE</span><span class="p">.</span><span class="nx">WebGLRenderer</span><span class="p">();</span>
      <span class="nb">document</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">renderer</span><span class="p">.</span><span class="nx">domElement</span><span class="p">);</span>
      <span class="nx">renderer</span><span class="p">.</span><span class="nx">setSize</span><span class="p">(</span><span class="nb">window</span><span class="p">.</span><span class="nx">innerWidth</span><span class="p">,</span> <span class="nb">window</span><span class="p">.</span><span class="nx">innerHeight</span><span class="p">);</span>

      <span class="c1">// création de la caméra</span>
      <span class="kd">var</span> <span class="nx">camera</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">THREE</span><span class="p">.</span><span class="nx">PerspectiveCamera</span><span class="p">(</span><span class="mi">45</span><span class="p">,</span> <span class="nb">window</span><span class="p">.</span><span class="nx">innerWidth</span> <span class="o">/</span> <span class="nb">window</span><span class="p">.</span><span class="nx">innerHeight</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">1000</span><span class="p">);</span>

      <span class="c1">// création de la scène</span>
      <span class="kd">var</span> <span class="nx">scene</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">THREE</span><span class="p">.</span><span class="nx">Scene</span><span class="p">();</span>

      <span class="c1">// couleur de fond noire</span>
      <span class="nx">scene</span><span class="p">.</span><span class="nx">background</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">THREE</span><span class="p">.</span><span class="nx">Color</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>

      <span class="c1">// création du groupe</span>
      <span class="kd">var</span> <span class="nx">group</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">THREE</span><span class="p">.</span><span class="nx">Group</span><span class="p">();</span>
      <span class="nx">scene</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">group</span><span class="p">);</span>

      <span class="c1">// création du premier cube et ajout dans le groupe</span>
      <span class="kd">var</span> <span class="nx">cube1</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">THREE</span><span class="p">.</span><span class="nx">Mesh</span><span class="p">(</span><span class="k">new</span> <span class="nx">THREE</span><span class="p">.</span><span class="nx">BoxGeometry</span><span class="p">());</span>
      <span class="nx">cube1</span><span class="p">.</span><span class="nx">position</span><span class="p">.</span><span class="nx">x</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
      <span class="nx">group</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">cube1</span><span class="p">);</span>

      <span class="c1">// création du second cube et ajout dans le groupe</span>
      <span class="kd">var</span> <span class="nx">cube2</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">THREE</span><span class="p">.</span><span class="nx">Mesh</span><span class="p">(</span><span class="k">new</span> <span class="nx">THREE</span><span class="p">.</span><span class="nx">BoxGeometry</span><span class="p">());</span>
      <span class="nx">cube2</span><span class="p">.</span><span class="nx">position</span><span class="p">.</span><span class="nx">x</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span><span class="p">;</span>
      <span class="nx">group</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">cube2</span><span class="p">);</span>

      <span class="c1">// positionnement de la caméra</span>
      <span class="nx">camera</span><span class="p">.</span><span class="nx">position</span><span class="p">.</span><span class="nx">z</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span>

      <span class="kd">function</span> <span class="nx">animate</span><span class="p">()</span> <span class="p">{</span>
        <span class="nx">cube1</span><span class="p">.</span><span class="nx">rotateX</span><span class="p">(</span><span class="mf">.1</span><span class="p">);</span>
        <span class="nx">cube2</span><span class="p">.</span><span class="nx">rotateX</span><span class="p">(</span><span class="mf">.1</span><span class="p">);</span>
        <span class="nx">group</span><span class="p">.</span><span class="nx">rotateZ</span><span class="p">(</span><span class="mf">.05</span><span class="p">);</span>
        <span class="nx">requestAnimationFrame</span><span class="p">(</span><span class="nx">animate</span><span class="p">);</span>
        <span class="nx">renderer</span><span class="p">.</span><span class="nx">render</span><span class="p">(</span><span class="nx">scene</span><span class="p">,</span> <span class="nx">camera</span><span class="p">);</span>
      <span class="p">}</span>

      <span class="nx">animate</span><span class="p">();</span>

    <span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
  <span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</pre></div>
</td></tr></table></div>
<p>Vous pouvez <a class="reference download internal" download="" href="../_downloads/f04a7b1fd4bad10edad308ca470e90a9/scene006.html"><code class="xref download docutils literal notranslate"><span class="pre">télécharger</span> <span class="pre">ce</span> <span class="pre">fichier</span> <span class="pre">directement</span></code></a>.</p>
<p>Dans l’exemple ci-dessus, chaque cube tourne autour de son axe X dans son repère
de coordonnées local et le groupe auquel ils appartiennent tourne autour de son
axe Z</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>Pour vous aider à visualiser les transformations, vous pouvez faire apparaître
les axes X, Y, Z grâce à l’objet 3D <a class="reference external" href="https://threejs.org/docs/index.html#api/en/helpers/AxesHelper">AxesHelper</a> qui prend en paramètre de construction
la longueur des axes à afficher.</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">cube1</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">THREE</span><span class="p">.</span><span class="nx">Mesh</span><span class="p">(</span><span class="k">new</span> <span class="nx">THREE</span><span class="p">.</span><span class="nx">BoxGeometry</span><span class="p">());</span>
<span class="nx">cube1</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="k">new</span> <span class="nx">THREE</span><span class="p">.</span><span class="nx">AxesHelper</span><span class="p">(</span><span class="mf">1.3</span><span class="p">));</span>
</pre></div>
</div>
<p class="last">Vous pouvez <a class="reference download internal" download="" href="../_downloads/dbaf3b7d088e28124635d79bfde55223/scene006b.html"><code class="xref download docutils literal notranslate"><span class="pre">télécharger</span> <span class="pre">la</span> <span class="pre">même</span> <span class="pre">scène</span> <span class="pre">avec</span> <span class="pre">l'affichage</span> <span class="pre">des</span> <span class="pre">axes</span></code></a>.</p>
</div>
</div>
<div class="section" id="excercice">
<h3>Excercice<a class="headerlink" href="#excercice" title="Lien permanent vers ce titre">¶</a></h3>
<div class="exercice admonition">
<p class="first admonition-title">Un premier système planétaire</p>
<p>Créez une scène affichant deux sphères. La première représentera la Terre et la
seconde la Lune. Les deux sphères doivent tourner sur elles-mêmes et la Lune
doit également tourner autour de la Terre. De plus, la rotation de la Lune sur elle-même
est telle que l’on voit toujours la même face depuis la Terre.</p>
<p>Pensez à utiliser des objets de type <a class="reference external" href="https://threejs.org/docs/index.html#api/en/objects/Group">Group</a> pour contrôler plus facilement
les différentes rotations.</p>
<div class="last admonition tip">
<p class="first admonition-title">Astuce</p>
<p class="last">Pour info, le rayon de la Terre est approximativement de 6 378 km et le rayon
de la Lune est approximativement de 1 737 km. Cela signifie que la Lune
à un rayon 0.2723 plus petite que celui de la Terre.</p>
</div>
</div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="materiaux.html" class="btn btn-neutral float-right" title="Les matériaux" accesskey="n" rel="next">Suivant <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="introduction.html" class="btn btn-neutral" title="Introduction et mise en place" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Précédent</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright David Gayerie - david.gayerie@epsi.fr - CC-BY-SA

    </p>
  </div>
    <div><a class="reference download" href="https://github.com/spoonless/epsi-i5-3d/archive/gh-pages.zip"><code class="download docutils literal notranslate"><span class="pre">Télécharger ce cours</pre></code></a></div>


</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="../_static/translations.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    

  

  <script type="text/javascript" src="../_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(false);
      });
  </script> 

</body>
</html>